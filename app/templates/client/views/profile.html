{% extends "./layout/base2.html" %}

{% block title %} {{ user['firstname'] }} {{ user['lastname'] }} {% endblock title %}

{% block content %}

    <div class="row">


            <div id="follow-btns">
                {% if current_user.get_id() != user.get_id() and is_following != True %}
                    <button id="btn-follow" class="btn btn-style-3">Follow</button>
                {% endif %}

                {% if current_user.get_id() != user.get_id() and is_following == True %}
                    <button id="btn-unfollow" class="btn btn-style-2">Unfollow</button>
                {% endif %}
            </div>

            <div class="col-md-12 col-sm-12 box-header box-style-2">
                <span>User</span>
            </div>

    </div>

{% endblock content %}

{% block scripts %}
    <script>
        function set_buttons() {
            $("#btn-follow").on('click', function() {
                $.ajax({
                    'url': "{{ url_for('api.follow_user', to_follow_id=user.get_id())}}",
                    'type': 'POST'
                }).done(function(data) {
                    $("#btn-follow").remove();
                    $("#follow-btns").append('<button id="btn-unfollow" class="btn btn-style-2">Unfollow</button>');
                    set_buttons();
                });
            });

            $("#btn-unfollow").on('click', function() {
                $.ajax({
                    'url': "{{ url_for('api.unfollow_user', to_unfollow_id=user.get_id())}}",
                    'type': 'POST'
                }).done(function(data) {
                    $("#btn-unfollow").remove();
                    $("#follow-btns").append('<button id="btn-follow" class="btn btn-style-3">Follow</button>');
                    set_buttons();
                });
            });
        }

        // initialize buttons
        set_buttons();

    </script>


{% endblock scripts %}